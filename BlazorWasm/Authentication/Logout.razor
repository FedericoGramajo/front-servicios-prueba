@attribute [Route(RouteConstants.Logout)]
@using ClientLibrary.Helper
@using Microsoft.AspNetCore.Components.Authorization
@inject IAuthenticationService authService
@inject NavigationManager navManager
@inject AuthenticationStateProvider authStateProvider
@inject ICookieStorageService cookieService
@using BlazorWasm.Authentication


<div class="d-flex align-items-center justify-content-center bg-light" style="min-height: calc(100vh - 150px);">
    <div class="text-center p-5 shadow-sm rounded bg-white" style="max-width: 400px; width: 100%;">
        <div class="mb-4">
            <i class="fa-solid fa-right-from-bracket fa-3x text-primary animate__animated animate__fadeOutRight"></i>
        </div>
        <h3 class="mb-3">Cerrando sesión...</h3>
        <p class="text-muted mb-4">¡Esperamos verte pronto!</p>
        <div class="spinner-border text-primary mb-3" role="status">
            <span class="visually-hidden">Cargando...</span>
        </div>
        <p class="small text-secondary mb-0">Te estamos redirigiendo al inicio.</p>
    </div>
</div>
@code {
    protected override async Task OnInitializedAsync()
    {
        try 
        {
            await authService.LogoutAsync();
        }
        catch (Exception ex)
        {
             Console.WriteLine($"Error during server logout: {ex.Message}");
        }
        finally 
        {
            await cookieService.RemoveCookieAsync(Constant.Cookie.Name);
        }
    }
protected override async Task OnAfterRenderAsync(bool firstRender)
{
    if (firstRender)
    {
        await Task.Delay(2000);
        navManager.NavigateTo(RouteConstants.Home, true);
    }
}
}